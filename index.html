<!DOCTYPE html>
<html>

<head>
    <title>Проект "Комменты"</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="styles.css" />
</head>

<body>
    <div class="container">
        <ul class="comments">
            <li class="comment">
                <div class="comment-header">
                    <div>Глеб Фокин</div>
                    <div>12.02.22 12:18</div>
                </div>
                <div class="comment-body">
                    <div class="comment-text">
                        Это будет первый комментарий на этой странице
                    </div>
                </div>
                <div class="comment-footer">
                    <div class="likes">
                        <span class="likes-counter">3</span>
                        <button class="like-button"></button>
                    </div>
                </div>
            </li>
            <li class="comment">
                <div class="comment-header">
                    <div>Варвара Н.</div>
                    <div>13.02.22 19:22</div>
                </div>
                <div class="comment-body">
                    <div class="comment-text">
                        Мне нравится как оформлена эта страница! ❤
                    </div>
                </div>
                <div class="comment-footer">
                    <div class="likes">
                        <span class="likes-counter">75</span>
                        <button class="like-button -active-like"></button>
                    </div>
                </div>
            </li>
        </ul>
        <div class="add-form">
            <input id="input-name" type="text" class="add-form-name" placeholder="Введите ваше имя" />
            <textarea type="textarea" class="add-form-text" placeholder="Введите ваш коментарий" rows="4"></textarea>
            <div class="add-form-row">
                <button class="add-form-button">Написать</button>
            </div>
            <div class="del-form-row">
                <button class="del-form-button" style="margin-left: 10px;">Удалить последний комментарий</button>
            </div>
        </div>
    </div>
</body>

<script>
    "use strict";

    const inputNameElement = document.getElementById("input-name");
    const inputTextElement = document.querySelector(".add-form-text");
    const buttonElement = document.querySelector(".add-form-button");
    const buttonDelElement = document.querySelector(".del-form-button");
    const listElement = document.querySelector(".comments");

    buttonElement.disabled = true;
    
    document.addEventListener("input", () => {
        if (inputNameElement.value !== "" && inputTextElement.value !== "") {
            buttonElement.disabled = false;
        } else {
            buttonElement.disabled = true;
        }
    });
    
    const addNewComment = () => {
        const nameUser = inputNameElement.value;
        const textUser = inputTextElement.value;
        const oldListHtml = listElement.innerHTML;

        const currentDate = new Date();
        const options = { year: 'numeric', month: 'numeric', day: 'numeric' };
        const date = currentDate.toLocaleDateString('ru-RU', options);

        let hour = currentDate.getHours();
        let minutes = currentDate.getMinutes();

        if (hour < 10 && hour > 0) {
            hour = "0" + hour;
        };

        if (minutes < 10) {
            minutes = "0" + minutes;
        };


        listElement.innerHTML = oldListHtml + `<li class="comment">
        <div class="comment-header">
            <div>${nameUser}</div>
            <div>${date} ${hour}:${minutes}</div>
        </div>
        <div class="comment-body">
            <div class="comment-text">${textUser}</div>
        </div>
        <div class="comment-footer">
            <div class="likes">
                <span class="likes-counter">0</span>
                <button class="like-button -active-like"></button>
            </div>
        </div>
    </li>`;

        inputNameElement.value = "";
        inputTextElement.value = "";
    };

    buttonElement.addEventListener("click", () => {
        addNewComment();
        buttonElement.disabled = true;
    })

    buttonDelElement.addEventListener("click", () => {
        let commentsList = listElement.innerHTML;
        const indexLastListElement = commentsList.lastIndexOf('<li class="comment">');
        const lastComment = commentsList.slice(indexLastListElement);
        listElement.innerHTML = commentsList.replace(lastComment, '');
        return;
    });


    inputTextElement.addEventListener("keyup", enter => {

        if (enter.code === 'Enter' && inputNameElement.value !== "" && inputTextElement.value !== "") {
            addNewComment();
            buttonElement.disabled = true;
        }
    });

    inputNameElement.addEventListener("keyup", enter => {

        if (enter.code === 'Enter' && inputNameElement.value !== "" && inputTextElement.value !== "") {
            addNewComment();
            buttonElement.disabled = true;
        }
    })

    console.log("It works!");
</script>



</html>